---
// Professional Interactive Quiz Component
import { Icon } from './Icon';

interface QuizOption {
  id: string;
  text: string;
  correct: boolean;
  explanation?: string;
}

interface Props {
  question: string;
  options: QuizOption[];
  quizId: string;
}

const { question, options, quizId } = Astro.props;
---

<div class="my-12 p-8 bg-gradient-to-br from-[hsl(var(--card))] to-[hsl(var(--muted))] rounded-2xl border border-[hsl(var(--border))] shadow-sm" data-quiz={quizId}>
  <!-- Quiz Header -->
  <div class="flex items-start gap-4 mb-6">
    <div class="flex-shrink-0 w-12 h-12 rounded-xl bg-gradient-to-br from-amber-500 to-orange-500 flex items-center justify-center shadow-lg">
      <Icon name="CircleQuestionMark" className="w-6 h-6 text-white" client:load />
    </div>
    <div class="flex-1">
      <div class="text-xs font-semibold text-[hsl(var(--muted-foreground))] uppercase tracking-wide mb-2">
        Knowledge Check
      </div>
      <h3 class="text-xl font-semibold text-[hsl(var(--foreground))] leading-tight">
        {question}
      </h3>
    </div>
  </div>

  <!-- Options -->
  <div class="space-y-3 mb-6">
    {options.map((option, index) => (
      <button
        type="button"
        class="quiz-option group w-full text-left p-5 bg-white dark:bg-[hsl(var(--card))] border-2 border-[hsl(var(--border))] rounded-xl hover:border-[hsl(var(--primary))] hover:shadow-md transition-all cursor-pointer relative overflow-hidden"
        data-quiz-option={option.id}
        data-correct={option.correct}
      >
        <div class="flex items-start gap-4">
          <div class="flex-shrink-0 w-8 h-8 rounded-lg bg-[hsl(var(--muted))] flex items-center justify-center text-sm font-semibold text-[hsl(var(--muted-foreground))] group-hover:bg-[hsl(var(--primary))] group-hover:text-white transition-colors">
            {String.fromCharCode(65 + index)}
          </div>
          <div class="flex-1">
            <span class="font-medium text-[hsl(var(--foreground))]">{option.text}</span>
            {option.explanation && (
              <span class="hidden" data-explanation>{option.explanation}</span>
            )}
          </div>
        </div>
      </button>
    ))}
  </div>

  <!-- Submit Button -->
  <button
    type="button"
    class="w-full sm:w-auto px-8 py-3 bg-[hsl(var(--primary))] text-white rounded-xl hover:bg-[hsl(var(--primary))]/90 transition-smooth disabled:bg-[hsl(var(--muted))] disabled:text-[hsl(var(--muted-foreground))] disabled:cursor-not-allowed font-semibold shadow-md disabled:shadow-none flex items-center justify-center gap-2"
    data-quiz-submit
    disabled
  >
    <Icon name="Send" className="w-5 h-5" client:load />
    <span>Submit Answer</span>
  </button>

  <!-- Feedback Section -->
  <div class="mt-6 hidden p-6 rounded-xl" data-quiz-feedback>
    <!-- Feedback will be inserted here by the script -->
  </div>
</div>

<style is:global>
  .quiz-option.selected {
    border-color: hsl(var(--primary));
    background-color: hsl(var(--primary) / 0.05);
  }

  .quiz-option.selected .w-8 {
    background-color: hsl(var(--primary));
    color: white;
  }

  .quiz-option.answered {
    cursor: default;
  }

  .quiz-option.answered:hover {
    border-color: hsl(var(--border));
    box-shadow: none;
  }

  .quiz-option.correct {
    border-color: hsl(var(--success));
    background-color: hsl(var(--success) / 0.1);
  }

  .quiz-option.correct .w-8 {
    background-color: hsl(var(--success));
    color: white;
  }

  .quiz-option.incorrect {
    border-color: hsl(var(--destructive));
    background-color: hsl(var(--destructive) / 0.05);
  }

  .quiz-option.incorrect .w-8 {
    background-color: hsl(var(--destructive));
    color: white;
  }

  [data-quiz-feedback].correct-answer {
    background: linear-gradient(135deg, hsl(var(--success) / 0.1) 0%, hsl(var(--success) / 0.05) 100%);
    border: 2px solid hsl(var(--success) / 0.3);
  }

  [data-quiz-feedback].incorrect-answer {
    background: linear-gradient(135deg, hsl(var(--destructive) / 0.1) 0%, hsl(var(--destructive) / 0.05) 100%);
    border: 2px solid hsl(var(--destructive) / 0.3);
  }
</style>
