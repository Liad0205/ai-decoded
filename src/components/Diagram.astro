---
// Wrapper for animated diagrams
interface Props {
  diagramId: string;
  title: string;
  autoplay?: boolean;
  animationDuration?: number;
}

const { diagramId, title, autoplay = false, animationDuration = 3000 } = Astro.props;
---

<div
  class="my-8 p-6 bg-[hsl(var(--card))] rounded-lg border border-[hsl(var(--border))]"
  data-diagram={diagramId}
  data-autoplay={autoplay}
  data-animation-duration={animationDuration}
>
  <h3 class="text-lg font-semibold text-[hsl(var(--foreground))] mb-4">{title}</h3>

  <div class="diagram-content mb-4">
    <slot />
  </div>

  <div class="flex gap-2">
    <button
      type="button"
      class="px-4 py-2 text-sm bg-[hsl(var(--primary))] text-[hsl(var(--primary-foreground))] rounded-lg hover:opacity-90 transition-smooth disabled:opacity-40 disabled:cursor-not-allowed"
      data-diagram-play
    >
      ▶ Play Animation
    </button>
    <button
      type="button"
      class="px-4 py-2 text-sm bg-[hsl(var(--muted))] text-[hsl(var(--muted-foreground))] rounded-lg hover:opacity-80 transition-smooth"
      data-diagram-reset
    >
      ↺ Reset
    </button>
  </div>
</div>

<style>
  .diagram-content {
    min-height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
</style>

<style is:global>
  /* Default animation for diagram children — uses is:global because
     Astro scoped styles can't reach slotted content.
     Lesson files can override with their own scoped <style> blocks. */
  [data-diagram] [data-animate] {
    opacity: 0;
    transform: translateY(12px);
  }

  [data-diagram] [data-animate].animating {
    animation: diagramReveal 0.6s ease-out forwards;
  }

  [data-diagram] [data-animate].animated {
    opacity: 1;
    transform: translateY(0);
  }

  @keyframes diagramReveal {
    from {
      opacity: 0;
      transform: translateY(12px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
